---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map((p) => ({ 
    params: { slug: p.slug }, 
    props: { post: p }
  }));
}

const { post } = Astro.props;

// Redirect to new clean URL structure
return Astro.redirect(`/${post.data.category}/${post.slug}/`, 301);
---
