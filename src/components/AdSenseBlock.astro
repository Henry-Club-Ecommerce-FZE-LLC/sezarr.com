---
import { SITE } from "../config/site";

interface Props {
  slot?: string;
  format?: 'auto' | 'rectangle' | 'leaderboard' | 'fluid';
  className?: string;
  style?: string;
  label?: string;
}

const { 
  slot = 'auto', 
  format = 'auto', 
  className = '', 
  style = '',
  label = 'Advertisement'
} = Astro.props;

// Define dimensions based on format
const getDimensions = (format: string) => {
  switch (format) {
    case 'leaderboard':
      return { width: 728, height: 90 };
    case 'rectangle':
      return { width: 336, height: 280 };
    default:
      return { width: '100%', height: 250 };
  }
};

const dimensions = getDimensions(format);
---

<aside class={`professional-ad-wrapper ${className}`} aria-label="Sponsored content">
  <div 
    class="professional-ad-block"
    style={style}
  >
    <!-- Ad Placeholder -->
    <div class="ad-placeholder">
      <div class="placeholder-content">
        <div class="placeholder-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="3" y="4" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
            <path d="M7 8h6M7 12h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="16" cy="10" r="1.5" fill="currentColor"/>
          </svg>
        </div>
        <p class="placeholder-text">Advertisement</p>
        <div class="placeholder-format">
          {format === 'leaderboard' ? '728×90' : format === 'rectangle' ? '336×280' : 'Responsive'}
        </div>
      </div>
    </div>

    <!-- AdSense Ad -->
    <ins 
      class="adsbygoogle"
      style={`display: block; width: ${typeof dimensions.width === 'number' ? dimensions.width + 'px' : dimensions.width}; height: ${typeof dimensions.height === 'number' ? dimensions.height + 'px' : dimensions.height};`}
      data-ad-client={SITE.ADSENSE_CLIENT || 'ca-pub-0000000000000000'}
      data-ad-slot={slot}
      data-ad-format={format}
      data-full-width-responsive="true"
    ></ins>
  </div>
</aside>

<style>
/* Professional AdSense Block Styling */
.professional-ad-wrapper {
  position: relative;
  margin: 1rem 0;
  width: 100%;
}

.professional-ad-block {
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  padding: 1rem;
  box-shadow: var(--shadow-small);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.professional-ad-block:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-medium);
  border-color: var(--brand-300);
}

.ad-placeholder {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  z-index: 1;
  transition: opacity 0.5s ease;
}

.placeholder-content {
  text-align: center;
  color: var(--text-muted);
}

.placeholder-icon {
  margin-bottom: 0.5rem;
  opacity: 0.6;
}

.placeholder-text {
  font-size: 0.875rem;
  font-weight: 600;
  margin-bottom: 0.25rem;
  color: var(--text-secondary);
}

.placeholder-format {
  font-size: 0.75rem;
  opacity: 0.7;
  color: var(--text-muted);
}

/* AdSense responsive adjustments */
@media (max-width: 768px) {
  .professional-ad-wrapper {
    margin: 0.75rem 0;
  }
}

/* Dark theme adjustments */
[data-theme="dark"] .ad-placeholder {
  background: var(--bg-tertiary);
  border-color: var(--border-color);
}

[data-theme="dark"] .professional-ad-block {
  background: var(--bg-secondary);
  border-color: var(--border-color);
}

/* High contrast mode */
@media (prefers-contrast: high) {
  .ad-placeholder,
  .professional-ad-block {
    border-width: 2px;
    border-color: var(--text-primary);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .ad-placeholder,
  .professional-ad-block {
    transition: none;
  }
  
  .professional-ad-block:hover {
    transform: none;
  }
}
</style>

<script>
// Simple AdSense initialization
(function() {
  function initAds() {
    const ads = document.querySelectorAll('.adsbygoogle');
    ads.forEach(function(ad) {
      try {
        (window.adsbygoogle = window.adsbygoogle || []).push({});
      } catch (e) {
        console.log('AdSense not loaded');
      }
    });
  }
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initAds);
  } else {
    setTimeout(initAds, 100);
  }
})();
</script>