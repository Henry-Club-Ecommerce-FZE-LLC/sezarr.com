---
import { SITE } from "../config/site";
const { slot = 'auto', format = 'fluid', label = 'Advertisement' } = Astro.props;
---
<aside class="my-6 text-center ad-space" style="contain: layout style;">
  <div class="text-xs text-gray-500 dark:text-gray-400 mb-1" aria-hidden="true">{label}</div>
  {/* Reserve space to prevent CLS */}
  <div class="ad-container" style="min-height: 250px; width: 100%; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; display: flex; align-items: center; justify-content: center;" class="dark:bg-gray-800 dark:border-gray-600">
    <ins class="adsbygoogle"
         style="display:block; width: 100%; height: 250px;"
         data-ad-client={SITE.ADSENSE_CLIENT}
         data-ad-slot={slot}
         data-ad-format={format}
         data-full-width-responsive="true"></ins>
  </div>
  <script>
    {`
    // Defer AdSense initialization to prevent CLS
    if (typeof window !== 'undefined') {
      requestIdleCallback(() => {
        (adsbygoogle=window.adsbygoogle||[]).push({});
      }, { timeout: 2000 });
    }
    `}
  </script>
</aside>

<style>
  .ad-container {
    contain: layout style;
  }
  
  .dark .ad-container {
    background: #1f2937;
    border-color: #374151;
  }
</style>
